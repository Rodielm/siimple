@use "sass:list";
@use "sass:map";
@use "siimple-lib" as lib;
@use "./index.scss" as icons;

// Check if we should include this icon
@function should-include-icon ($icon, $include, $exclude) {
    @if list.length($include) == 0 and list.length($exclude) == 0 {
        @return true; //No include/exclude list provided
    }
    // Check if this icon is excluded
    @if list.index($exclude, $icon) {
        @return false; // Icon excluded
    }
    // Check if this icon is included
    @else if list.index($include, $icon) {
        @return true;
    }
    // Fallback --> exclude icon
    @return false;
}

// Generate icons component configuration
@mixin all ($options: lib.empty-map()) {
    $icons-name: lib.get-in($options, "name", "siimple-icons");
    $icons-path: lib.get-in($options, "path", "../fonts/");
    $include: lib.get-in($options, "include", ());
    $exclude: lib.get-in($options, "exclude", ());
    //Build sheet
    @include lib.use-font($icons-name, (
        "sources": (
            "truetype": "#{$icons-path}#{$icons-name}.ttf",
            "woff": "#{$icons-path}#{$icons-name}.woff",
            "woff2": "#{$icons-path}#{$icons-name}.woff2",
        ),
        "weight": "normal",
        "style": "normal",
    ));
    // Build icons component config
    @include lib.use-component-selector("icon") {
        align-self: center;
        display: inline-flex;
        font-family: lib.unquote($icons-name);
        //font-size": "default",
        font-style: normal;
        font-weight: normal !important;
        line-height: lib.get-in($options, "line-height", 1);
        text-rendering: auto;
        -moz-osx-font-smoothing: grayscale;
        -webkit-font-smoothing: antialiased;
        &::before {
            box-sizing: border-box; //inherit;
            display: block;
        }
        //Icons list
        @each $icon in icons.get-all-icons() {
            @if should-include-icon($icon, $include, $exclude) {
                @include lib.use-variant-selector($icon) {
                    &::before {
                        content: icons.include-icon($icon);
                    }
                }
            }
        }
    }
    // Build font sources
    //@include lib.compile-sheet($icons-sheet);
}

