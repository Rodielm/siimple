@use "sass:map";
@use "siimple:lib" as lib;
@use "siimple:icons" as icons;

// @description Icons plugin entrypoint
@function icons($options: lib.empty-map()) {
    $icons-name: lib.get-in($options, "name", "siimple-icons");
    $icons-path: lib.get-in($options, "path", "../fonts/");
    $include: lib.get-in($options, "include", ());
    $exclude: lib.get-in($options, "exclude", ());
    // Generate icons variants
    $icons-variants: lib.empty-map();
    @each $icon in icons.get-icons() {
        @if lib.is-enabled($icon, $include, $exclude) {
            $icons-variants: map.set($icons-variants, $icon, (
                "&::before": (
                    "content": icons.include-icon($icon),
                ),
            ));
        }
    }
    // Generate icons plugin
    @return (
        // Icons font
        lib.create-font-plugin((
            "name": $icons-name,
            "sources": (
                "truetype": "#{$icons-path}#{$icons-name}.ttf",
                "woff": "#{$icons-path}#{$icons-name}.woff",
                //"woff2": "#{$icons-path}#{$icons-name}.woff2",
            ),
            "weight": "normal",
            "style": "normal",
        )),
        // Icons component
        lib.create-component-plugin((
            "id": "icon",
            "name": "icon",
            "styles": (
                "align-self": center,
                "display": inline-flex,
                "font-family": $icons-name,
                //"font-size": "default",
                "font-style": normal,
                "font-weight": (normal "important"),
                "line-height": lib.get-in($options, "line-height", 1),
                "text-rendering": auto,
                "-moz-osx-font-smoothing": grayscale,
                "-webkit-font-smoothing": antialiased,
                "&::before": (
                    "box-sizing": border-box, //inherit;
                    "display": block,
                ),
            ),
            "variants": $icons-variants,
        )),
    );
}

